version: "2.3"

services:
  node:
    volumes:
      - source: .
        target: /monofo
        type: bind
    image: ${NODE_IMAGE_TAG:-239595706494.dkr.ecr.us-west-2.amazonaws.com/monofo:node-main}

  plugin-lint:
    image: buildkite/plugin-linter
    command: /plugin/.buildkite/plugin-lint
    entrypoint: []
    volumes:
      - ".:/plugin"

  plugin-test:
    image: buildkite/plugin-tester
    command: bats -r hooks/
    volumes:
      - ".:/plugin:ro"
