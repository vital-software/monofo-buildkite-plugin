name: Monofo
description: Dynamically generates monorepo pipelines from multiple subprojects
author: https://github.com/vital-software
requirements:
  - git
  - aws
  - npx
  - mktemp
configuration:
  properties:
    generate:
      type: string
      enum:
        - pipeline
    upload:
      type: object
      patternProperties:
        '^[^/]*\.tar(\.lz4|\.caidx)?$':
          oneOf:
            - type: array
              items:
                oneOf:
                  - type: string
                  - type: object
                    properties:
                      from: { type: string }
                      to:   { type: string }
                    additionalProperties: false
            - type: object
              required:
                - filesFrom
              properties:
                filesFrom: { type: string }
                null:      { type: boolean }
              additionalProperties: false
    download:
      type: array
      items:
        type: string
  additionalProperties: false
